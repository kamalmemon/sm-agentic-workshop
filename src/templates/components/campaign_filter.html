<div class="bg-starwars-gray rounded-lg border border-starwars-steel p-5">
    <label for="campaign-select" class="block text-xs font-starwars font-bold text-starwars-yellow mb-3 uppercase tracking-widest">
        Select Your Mission
    </label>
    <select id="campaign-select" name="campaign_id"
        class="block w-full md:w-80 rounded-lg border-2 border-starwars-steel bg-starwars-space text-starwars-jedi font-galactic py-3 px-4 focus:border-starwars-jedi focus:ring-starwars-jedi"
        hx-get="/metrics/all" hx-target="#metrics-section" hx-swap="innerHTML"
        hx-trigger="change" hx-include="this"
        onchange="htmx.trigger(document.body, 'campaignChanged', {campaign_id: this.value})">
        <option value="">All Campaigns</option>
        {% for campaign in campaigns %}
        <option value="{{ campaign.id }}" {% if campaign.id == selected_id %}selected{% endif %}>
            {{ campaign.name }} ({{ campaign.status }})
        </option>
        {% endfor %}
    </select>
</div>
<script>
document.body.addEventListener('htmx:configRequest', function(evt) {
    const select = document.getElementById('campaign-select');
    if (select && select.value && !evt.detail.path.includes('campaign_id')) {
        evt.detail.parameters['campaign_id'] = select.value;
    }
});
</script>
